<!DOCTYPE html>
<!-- [html-validate-disable no-trailing-whitespace] -->
<html lang="nl">

<head>
  <title>Visual Studio | Ontwikkelomgeving</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="common/styles.css">
  <link rel="stylesheet" href="css/styles.css">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>

<body class="prism-vslight language-cs showpro">
  <div id="mode">
    <span>n00b</span>
    <label class="switch">
      <input type="checkbox" checked>
      <span class="slider round"></span>
    </label>
    <span>pro</span>
  </div>
  <nav class="site__nav">
    <a href="01_browser.html" class="main__thumb" title="01. browser">
      <p class="thumb__title">01. browser</p>
      <img class="thumb__visual" src="img/01_browser/icon.jpg" alt="">
    </a>
    <a href="02_vscode.html" class="main__thumb" title="02. VS code">
      <p class="thumb__title">02. VS Code</p>
      <img class="thumb__visual" src="img/02_vscode/icon.png" alt="">
    </a>
    <a href="03_github.html" class="main__thumb" title="03. Github">
      <p class="thumb__title">03. Github</p>
      <img class="thumb__visual" src="img/03_github/icon.jpg" alt="">
    </a>
    <a href="04_visualstudio.html" class="main__thumb active" title="04. Visual Studio">
      <p class="thumb__title">04. VIsual Studio</p>
      <img class="thumb__visual" src="img/04_visualstudio/icon.jpg" alt="">
    </a>
  </nav>
  <h1>04. Visual Studio</h1>
  <p class="othercourses"><small>Dit hoofdstuk is onderdeel van de cursus <a href="https://rogiervdl.github.io/DEVENV-course/">Ontwikkelomgeving</a>. Andere cursussen in dezelfde reeks: <a href="https://rogiervdl.github.io/HTML-course/">HTML</a>, <a href="https://rogiervdl.github.io/CSS-course/">CSS</a>, <a href="https://rogiervdl.github.io/JS-course/">Javascript</a>, <a href="https://rogiervdl.github.io/CS-course/">C#</a>.</small></p>
  <div id="toc"></div>
  <main>

    <!-- VIDEO -->
    <!-- <h2>Youtube</h2>
      <h3>IIP &mdash; Visual Studio &amp; WPF</h3>
      <div class="flexcontainer youtubecontainer">
         <iframe class="youtube" width="600" height="378"
            src="https://www.youtube.com/embed/d8eND5KaB1c?si=E-pocp4_tyDvW2IV" title="YouTube video player"
            allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
            allowfullscreen></iframe>
         <figure class="print">
            <a href="https://www.youtube.com/watch?v=d8eND5KaB1c"><img src="img/04_visualstudio/youtube-visualstudio-wpf.png" alt="" class="w-500"></a>
            <figcaption><a href="https://www.youtube.com/watch?v=d8eND5KaB1c">https://www.youtube.com/watch?v=d8eND5KaB1c</a>
            </figcaption>
         </figure>
         <div class="youtube_toc">
            <ul>
               <li>
                  <a href="https://www.youtube.com/watch?v=d8eND5KaB1c?t=120">2:10 Visual Studio</a>
                  <ul>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c?t=144">2:24 solution aanmaken</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=164">2:44 WPF project aanmaken</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=201">3:21 overzicht Visual Studio panelen; WPFHelloWorld dem</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=965">16:05 console project; ConsoleHelloWorld demo</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1160">19:20 bestaande projecten toevoegen, verwijderen en verplaatsen </a></li>
                  </ul>
               </li>
               <li>
                  <a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1226">20:26 WPF controls overzicht</a>
                  <ul>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1255">20:55 Label</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1285">21:25 Button</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1369">22:49 Checkbox</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1539">25:39 ComboBox</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=1860">31:00 Image</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=2197">36:37 ListBox</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=2354">39:14 RadioButton</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=2686">44:46 TextBox</a></li>
                     <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=2804">46:44 Slider en Rectangle</a></li>
                  </ul>
               </li>
               <li><a href="https://www.youtube.com/watch?v=d8eND5KaB1c&t=3123">52:03 Shortcuts</a></li>
            </ul>
         </div>
      </div> -->


    <h2>Wat is programmeren</h2>
    <h3>.NET Framework</h3>
    <p>Als je programmeert, maak je altijd gebruik van bundel vooraf geschreven code waarop je kan voortbouwen. Het zou niet handig zijn als je bij elk programma opnieuw knoppen, dialoogvensters, scrollbars enz... vanaf nul moet programmeren! Een dergelijke bundel noemt men een <strong>framework</strong>.</p>
    <p>Frameworks bestaan in veel gebieden: </p>
    <ul>
      <li><strong>game programming</strong>: Unity3D, Unreal, ...</li>
      <li><strong>web &amp; mobile apps</strong>: Ionic, Phonegap, React, Angular, ...</li>
      <li><strong>3D programming</strong>: ThreeJS, Babylon, ...</li>
      <li>â€¦</li>
    </ul>
    <p>In deze cursus gebruiken we het <strong>.NET Framework</strong>: het is weliswaar voornamelijk gericht op Windows apps, maar ook op mobiele (Android bv) of cloud toepassingen. Het werkt bovendien naadloos samen met C#.</p>
    <p><img src="img/04_visualstudio/logo dotnet.jpg" alt="" class="w-150"></p>
    <div class="tips" data-caption="ðŸ¤” FRAMEWORK OF LIBRARY?">
      <p>
        De term <em>famework</em> wordt vaak verward met <em>library</em>. Er is nochtans een duidelijk verschil:
      </p>
      <ul>
        <li>Een <strong>framework</strong> is een <em>fundamentele structuur</em> die als basis dient voor het schrijven van programma's, b.v. .NET, Angular (Javascript), Spring (Java)... Je <strong>plugt je code in een framework</strong>. </li>
        <li>Een <strong>library</strong> is een <em>pakket herbruikbare code</em> die je in je projecten kan gebruiken, b.v. <a href="https://scottplot.net/">ScottPlot.NET</a> voor grafieken. Het is eerder een hulp; je <strong>plugt een library in je code</strong>.</li>
      </ul>
      <p>Verwar een library dan weer niet met een <strong>package</strong>, wat in .NET een manier is om libraries, scripts, tools enz... toe te voegen aan je .NET projecten &mdash; vergelijkbaar met extensies in VS Code, plugins in browsers en node modules in NodeJS. De gebruikte tool is NuGet Package Manager; we zullen dit later gebruiken voor de <a href="#stylecopanalyzers">StyleCop.Analyzers</a> code quality tool.</p>
    </div>
    <h3>Fasen van een programma</h3>
    <p>
      Een <strong>programma</strong> is een opeenvolging van instructies die in een bepaalde volgorde worden uitgevoerd. Het hele proces van code tot uitvoering bestaat uit drie grote stappen. Grafisch samengevat:</p>
    <p><img src="img/04_visualstudio/build-proces.png" alt="" class="w-800"></p>
    <h4>Coderen</h4>
    <p>Dit is het schrijven van een programma, b.v. C# in de Visual Studio ontwikkelomgeving. </p>
    <img src="img/04_visualstudio/build-proces-1.png" alt="" class="w-400">

    <h4>Builden</h4>
    <p>Als je klaar bent, ga je naar de volgende stap, het builden (shortcut: <strong>Ctrl-B)</strong></p>
    <img src="img/04_visualstudio/build-proces-2.png" alt="" class="w-500">
    <p>
      De code wordt in verschillende stappen omgezet naar een .exe bestand met platform-onafhankelijke tussencode, <mark>CIL</mark> of <strong>Common Intermediate Language</strong> genoemd, bestaande uit low-level instructies of <mark>bytecodes</mark>. Voor de geÃ¯nteresseerden: je kan de bytecodes zien door de .exe te openen in tools als <a href="https://apps.microsoft.com/detail/xp8c26vdwlp4t4?hl=en-us&gl=BE">ILSpy</a>. Enkele aspecten van het build proces:
    </p>
    <ul>
      <li><strong>linking</strong>: combineren van alle bronnen, codefiles, libraries, referenties enz... in Ã©Ã©n bestand</li>
      <li><strong>compiling</strong>: vertaling van hig-level C# code naar low-level bytecodes </li>
    </ul>
    <p>In de output kan je zien of er buildfouten zijn:</p>
    <img src="img/04_visualstudio/build-proces-3.png" alt="" class="w-500">
    <p>Als de build gelukt is, komen er twee mappen bij in je project:</p>
    <img src="img/04_visualstudio/build-proces-4.png" alt="" class="w-400">
    <ul>
      <li><strong>bin</strong>: bevat de binaire (uitvoerbare) bestanden</li>
      <li><strong>obj</strong>: bevat tijdelijke en intermediarie bestanden</li>
    </ul>
    <div class="tips" data-caption="ðŸ’¡TIP">
      <p>
        Sommige buildproblemen kan je oplossen door de bin en obj mappen handmatig te verwijderen, en opnieuw te builden.
      </p>
    </div>
    <h4>Uitvoeren</h4>
    <p>Je kan het programma nu starten vanuit Visual Studio (shortcut: <strong>Ctrl-F5</strong>):</p>
    <img src="img/04_visualstudio/build-proces-5.png" alt="" class="w-500">
    <p>Je kan het programma ook starten door het rechtstreeks te starten in de bin map:</p>
    <img src="img/04_visualstudio/build-proces-6.png" alt="" class="w-500">
    <p>De .NET Common Language Runtime (CLR) zal tijdens de uitvoering (<mark>JIT</mark>: <strong>just in time</strong>) de bytecode vertalen in platform-specifieke machine-instructies. </p>
    <h3>Soorten fouten</h3>
    <p>In elke fase van het programma kunnen fouten optreden:</p>
    <ol>
      <li><strong>syntax error</strong>: je code bevat een fout tegen de vormregels van de programmeertaal, bv. puntkomma of haakje vergeten</li>
      <li><strong>build error</strong>: je code is correct geschreven, maar tijdens het builden loopt iets fout, bv. een bibliotheek wordt niet gevonden</li>
      <li><strong>runtime error</strong>: je code compileert netjes, maar tijdens het uitvoeren loopt je programma vast, bv. een onverwachte deling door nul, geheugenfout, bestand wordt niet gevonden enz...</li>
      <li><strong>logical error</strong>: je programma loopt niet vast, maar doet niet wat je verwacht, bv. de output is verkeerd of een knop werkt niet</li>
    </ol>

    <h3>Integrated Development Environment (IDE)</h3>

    <p>
      De ontwikkelomgeving of <mark>Integrated Development Environment</mark> is de omgeving waarin je programma's ontwikkelt. Typische features van IDE's:
    </p>
    <ul>
      <li>werken met <strong>solutions &amp; projecten</strong></li>
      <li><strong>code schrijven</strong>: code editor, code hints, automatische layout, object browser...</li>
      <li><strong>interfaces bouwen</strong> (vensters, knoppen, menu's...) met de designer</li>
      <li>programma's <strong>builden en runnen</strong>, eventueel simulators (bv. mobiele devices)</li>
      <li>tools om te <strong>debuggen</strong> (foutopsporing),&nbsp;</li>
      <li><strong>testen</strong>: unit tests, performantie metingen, analyse geheugengebruik...</li>
      <li><strong>samenwerking</strong>: versiebeheer, code review, live sharing...</li>
      <li><strong>distributie</strong>: cloud integratie, publicatie op het web...</li>
      <li>...</li>
    </ul>
    <p>
      De meest gebruikte omgeving voor C# Visual Studio (versie 2022 op moment van schrijven).
    </p>

    <h2>Installatie Visual Studio</h2>
    <h3>Downloaden</h3>
    <p>Download en installeer Visual Studio gratis vanop <a href="https://visualstudio.microsoft.com/free-developer-offers/">https://visualstudio.microsoft.com/free-developer-offers/</a> (Visual Studio Community)</p>
    <p><img src="img/04_visualstudio/vs-download.png" alt="" class="w-500"></p>

    <h3>Keuze workload</h3>
    <p>In Visual Studio kan je programmeren in <strong>verschillende talen</strong> (en zelfs meerdere tegelijk in Ã©Ã©n project): Javascript, Python, C++, Visual Basic, R, F#, C#... en voor <strong>verschillende platforms</strong> (Windows, Azure, Android, Webâ€¦).&nbsp;Daarom biedt Visual Studio een heel aantal verschillende standaardomgevingen, <strong>workload</strong> genoemd, met tools, omgeving enz... aangepast aan jouw specifieke ontwikkelingsbehoeften. Wij gebruiken de <strong>.NET desktop environment</strong>; let er dus op dat je de juiste omgeving kiest tijdens installatie.</p>
    <figure>
      <img src="img/04_visualstudio/workload.png" alt="" class="w-800">
      <figcaption>kies voor .NET desktop development</figcaption>
    </figure>

    <h3>Selecteren individuele componenten</h3>
    <p>Je kan tijdens installatie (of achteraf) individuele componenten kiezen, b.v. support voor oudere versies van .NET. Je kan dit deel voorlopig overslaan; individuele componenten kan je achteraf nog altijd selecteren via de <strong>Visual Studio installer</strong>.</p>
    <figure>
      <img src="img/04_visualstudio/components.png" alt="" class="w-800">
      <figcaption>selectie componenten (kan ook achteraf nog via Visual Studio installer)</figcaption>
    </figure>

    <h3>Taalkeuze</h3>
    <p>Het is sterk aangeraden de taal van Visual Studio op <strong>Engels</strong> in te stellen. Dit maakt het b.v. makkelijker foutmeldingen op te zoeken, en de interface sluit dan aan bij de screenshots in deze cursus. Standaard wordt de taal van Windows gekozen; bij veel studenten zal dat Frans of Nederlands zijn. Verander dit naar Engels via <strong>Tools, Options, Environment, International Settings</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/language.png" alt="" class="w-500 bordered">
      <figcaption>kies voor Engels</figcaption>
    </figure>
    <p>Staat Engels er niet tussen? Voeg het dan toe via de Visual Studio Installer.</p>

    <h2>Personaliseren</h2>
    <h3>Thema veranderen</h3>
    <p>Pas het kleurschema aan via <strong>Tools, Theme</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/ui-theme.png" alt="" class="w-700">
      <figcaption>pas kleurschema aan</figcaption>
    </figure>

    <h3>Panels toevoegen</h3>
    <p>Voeg panels toe via <strong>View</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/ui-window.png" alt="" class="w-1000">
    </figure>

    <h3>Panels pinnen</h3>
    <p>Pin/unpin panels zodat ze altijd zichtbaar/ingeklapt weergegeven worden:</p>
    <figure>
      <img src="img/04_visualstudio/ui-pin.gif" alt="" class="w-600 bordered">
    </figure>

    <h3>Panels docken</h3>
    <p>Kiezen waar je een panel plaatst heet <mark>docken</mark>. Opties zijn links, boven, rechts, onder en centraal. Versleep eenvoudigweg het panel aan de bovenbalk naar een nieuwe plaats:</p>
    <figure>
      <img src="img/04_visualstudio/ui-docking.png" alt="" class="w-1000">
    </figure>


    <h2>Solutions en projecten</h2>

    <h3>Solution vs. project</h3>
    <ul>
      <li>een <mark>project</mark> groepeert alle <strong>bestanden</strong> die bij Ã©Ã©n programma horen: codebestanden, afbeeldingen, configuratiebestanden...</li>
      <li>een <mark>solution</mark> groepeert een aantal <strong>projecten</strong> die om Ã©Ã©n of andere reden logisch bij elkaar horen</li>
    </ul>
    <p>Hoe code georganiseerd wordt in solutions en projecten hangt af van vak tot vak. Voor <strong>Introductie in Programmeren</strong> (ORP42a, graduaat) en <strong>OO Application Development</strong> (OBI25a, bachelors) wordt gekozen voor <strong>Ã©Ã©n solution per les, Ã©Ã©n project per oefening</strong>. Hieronder een screenshot van een typische les geopend in Visual Studio.</p>
    <figure>
      <img src="img/04_visualstudio/projects-solutions.png" alt="" class="w-1000">
    </figure>
    <p>Je herkent:</p>
    <ul>
      <li>de solution <em>SlnBasis</em>; dit is de les waamee we bezig zijn</li>
      <li>de projecten <em>ConsoleAsciiArt</em>, <em>ConsoleGedicht</em>, <em>ConsoleHalloWereld</em>...; dit zijn de oefeningen behorende bij die les</li>
      <li>de bronnen <em>Properties, References, App.config, Program.cs</em> onder <em>ConsoleHalloWereld</em>: dit zijn de bestanden/mappen behorende bij die oefening</li>
      <li>het codevenster links: hierin schrijf je je code</li>
    </ul>

    <h3>Solution (=les) openen</h3>
    <p>In Visual Studio open je <strong>nooit een folder</strong>, maar een <strong>solution</strong>. Dit doe je door te dubbelklikken op het <strong>.sln</strong> solutionbestand van die les in verkenner:</p>
    <figure>
      <img src="img/04_visualstudio/solution-openen.png" alt="" class="w-1200">
    </figure>

    <h3>Project (=oefening) toevoegen</h3>
    <p>
      Voor elke oefening voegen we een nieuw project toe aan de solution van die les. De eenvoudigste manier is met de rechtermuisknop op de solution, <strong>Add, New Project...</strong>:
    </p>
    <figure>
      <img src="img/04_visualstudio/project-toevoegen2.png" alt="" class="w-600 bordered">
    </figure>
    <p>
      In het volgende venster kan je kiezen uit heel veel projecttypes. In het volgende dialoogvenster je filtert best alvast op <strong>taal</strong> (C#) en <strong>platform</strong> (Windows):
    </p>
    <figure>
      <img src="img/04_visualstudio/filteren.png" alt="" class="w-800">
    </figure>


    <h3>Project types</h3>
    <p>In eerstejaarsvakken komen hoofdzakelijk deze twee types aan bod: </p>
    <ul>
      <li><mark>Console application</mark>: programma uitgevoerd in een simpel commandprompt-achtig venster</li>
      <li><mark>WPF application</mark>: een typisch Windows programma in een venster met menuâ€™s, knoppen, dialoogvensters, scrollbarsâ€¦</li>
    </ul>
    <p>Op het einde van OO Application Development komt ook nog de <mark>class library</mark> aan bod, maar dat is voor <a href="10_sql_databanken.html#class-library-aanmaken">dit hoofdstuk</a>.</p>
    <figure>
      <img src="img/04_visualstudio/console.png" alt="" class="w-500">
      <figcaption>typische console app</figcaption>
    </figure>
    <figure>
      <img src="img/04_visualstudio/wpf.png" alt="" class="w-500">
      <figcaption>typische WPF app</figcaption>
    </figure>
    <p>
      Console toepassingen hebben beperktere mogelijkheden dan WPF; daar staat tegenover dat je kan focussen op de essentie van leren programmeren.
      WPF toepassingen aan de andere kant laten toe snel een interface te bouwen met knoppen, menu's, sliders, date pickers enz... wat het dan weer makkelijker maakt complexere toepassingen te bouwen, al vraagt het meer kennis van Visual Studio.
      Sommigen studenten schrijven liever console toepassingen, anderen geven de voorkeur aan WPF, maar bij de meesten is er geen duidelijke voorkeur.
    </p>
    <p>
      Wij zijn ervan overtuigd dat <strong>beide projecttypes elkaar aanvullen</strong> als manier om te leren programmeren.
    </p>

    <h2>Console Application</h2>
    <p>Een console applicatie draait dus in de console, i.e. een soort commandprompt-achtig venster. De mogelijkheden zijn beperkter dan bij WPF toepassingen, vooral grafische en UI componenten ontbreken. Enkele voorbeelden van wat wel/niet kan:</p>
    <ul>
      <li class="right">tekst in- en output</li>
      <li class="right">voor- en achtergrondkleur</li>
      <li class="right">muziek en andere geluiden</li>
      <li class="right">bestanden lezen en schrijven</li>
      <li class="right">werken met databanken</li>
      <li class="wrong">grafische vormen als ellipsen, rechthoeken...</li>
      <li class="wrong">form controls</li>
      <li class="wrong">video</li>
      <li class="wrong">UI componenten als menu's, scrollbars...</li>
      <li class="wrong">dialoogvensters (bestanden openen e.d.)</li>
    </ul>
    <h3>Aanmaken</h3>

    <p>Om een console toepassing te maken, open je eerst de solution van de les. Dan voeg je zoals steeds een project toe met <strong>Add, New Project...</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/project-toevoegen2.png" alt="" class="w-600 bordered">
    </figure>
    <p>In het volgende venster kies je voor Console App:</p>
    <figure>
      <img src="img/04_visualstudio/console-app.png" alt="" class="w-600 bordered">
    </figure>
    <div class="tips" data-caption="ðŸ’£ PAS OP">
      <p>
        Je vindt mogelijks nog andere versies zoals <strong>Console App (.NET Core)</strong> of <strong>Console App (.NET Framework)</strong>. Dit zijn (sterk) verouderde types, die mag je niet gebruiken! Let er dus op dat het type exact is als op de screenshot.
      </p>
    </div>
    <p>Kies de naam van het project <strong>exact hetzelfde als de naam van de oefening</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/console-add.png" alt="" class="w-800">
    </figure>
    <p>In het laatste venster kies je voor de laatste versie, en duid aan dat je <strong>geen top-level statements</strong> wil:</p>
    <figure>
      <img src="img/04_visualstudio/console-additional.png" alt="" class="w-700 bordered">
    </figure>
    <h3>Voorbeeld: ConsoleHalloWereld</h3>
    <p>Tenslotte kan je de code van het programma intypen:</p>
    <figure>
      <img src="img/04_visualstudio/console-code.png" alt="" class="w-900 bordered">
    </figure>
    <p>Run het programma via F5 of deze knop:</p>
    <figure>
      <img src="img/04_visualstudio/console-run.png" alt="" class="w-600 bordered">
    </figure>
    <p>Het programma in actie:</p>
    <figure>
      <img src="img/04_visualstudio/ConsoleHalloWereld.gif" alt="" class="w-500 bordered">
      <figcaption>resultaat in de console</figcaption>
    </figure>

    <h2>WPF Application</h2>
    <p>
      WPF staat voor <mark>Windows Presentation Foundation</mark>, een technologie van Microsoft om Windows toepassingen te bouwen.
      Ze hebben een grafische interface met knoppen, menu's, sliders, tekstvakken, afbeeldingen... en zijn daardoor visueel aantrekkelijker dan console applicaties. De mogelijkheden zijn dus uitgebreider dan Console toepassingen, maar de leercurve is ook steiler.
    </p>
    <h3>Aanmaken</h3>
    <p>Om een WPF toepassing te maken, open je weer eerst de solution van de les. Dan voeg je zoals steeds een project toe met <strong>Add, New Project...</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/project-toevoegen2.png" alt="" class="w-600 bordered">
    </figure>
    <p>In het volgende venster kies je voor WPF Application:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-app.png" alt="" class="w-600 bordered">
    </figure>
    <div class="tips" data-caption="ðŸ’£ PAS OP">
      <p>
        Je vindt mogelijks nog andere versies zoals <strong>Windows Forms Application</strong> of <strong>WPF App (.NET Framework)</strong>. Dit zijn (sterk) verouderde types, die mag je niet gebruiken! Let er dus op dat het type exact is als op de screenshot.
      </p>
    </div>
    <p>Kies de naam van het project <strong>exact hetzelfde als de naam van de oefening</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-add.png" alt="" class="w-800">
    </figure>
    <p>In het laatste venster kies je voor de laatste versie:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-additional.png" alt="" class="w-700 bordered">
    </figure>
    <h3>Designer</h3>
    <p>WPF toepassingen hebben twee aparte delen:</p>
    <ul>
      <li><mark>designer</mark>: drag-drop interface (versleep controls uit de toolbox links) &rarr; XAML code in <strong>MainWindow.xaml</strong></li>
      <li><mark>code-behind</mark>, de &ldquo;code achter het design&rdquo;: geschreven in <strong>C#</strong> code &rarr; C# code in <strong>MainWindow.xaml.cs</strong></li>
    </ul>
    <p>In de designer kan je controls toevoegen en properties instellen; de gegenereerde <mark>XAML</mark> (spreek uit: &ldquo;zammel&rdquo;) middenonder kan je ook rechtstreeks met de hand aanpassen of aanvullen.</p>
    <figure>
      <img src="img/04_visualstudio/wpf-designer.png" alt="" class="w-800 bordered">
    </figure>
    <h4>XAML manueel aanpassen</h4>
    <p>De XAML code wordt automatisch gegenereerd via de designer, maar het lijkt qua structuur sterk op HTML. Hou je dus zeker niet in met de hand aanpassingen te doen (zie b.v. deze opmaakproperties in <a href="https://rogiervdl.github.io/CS-course/07_wpfcontrols.html#wpf-controls-opmaken">de C# cursus</a>):</p>
    <figure>
      <img src="img/04_visualstudio/xaml-edit.png" alt="" class="w-500 bordered">
    </figure>
    <h4>Controls toevoegen</h4>
    <p>Een WPF component als Button, TextBox enz... toevoegen heet een <mark>WPF control</mark>. In het <a href="03_wpfcontrols.html">hoofdstuk WPF Controls</a> komen we uitgebreid op terug op alle controls en hun gebruik. Voeg ze toe door verslepen uit de Toolbox:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-addcontrol1.png" alt="" class="w-500 bordered">
      <img src="img/04_visualstudio/wpf-addcontrol2.png" alt="" class="w-500 bordered">
    </figure>
    <h4>Eigenschappen instellen</h4>
    <p>De volgende stap is het instellen van alle eigenschappen:</p>
    <ul>
      <li><strong>naam</strong> van de control</li>
      <li><strong>opmaak</strong>: tekst, kleur, lettertype, grootte...</li>
      <li><strong>layout</strong>: positie, grootte, marges...</li>
      <li><strong>events</strong> (wat gebeurt er als je op de knop klikt?)</li>
      <li>...</li>
    </ul>
    <h5>naam</h5>
    <p>Controls die je later nodig hebt, geef je best onmiddellijk een naam:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-control-name.png" alt="" class="w-800 bordered">
    </figure>
    <div class="tips" data-caption="ðŸ’¡TIP">
      <p>
        Controls als titels of vaste afbeeldingen die je niet nodig hebt in je programmeercode later, hoef je <em>geen</em> naam te geven.
      </p>
    </div>
    <div class="tips" data-caption="âš–ï¸ REGEL">
      <p>
        We gebruiken de <mark>Hongaarse notatie</mark>: een drieletter prefix plus een omschrijving in PascalCase. <br>Voorbeelden: <strong>btnOk</strong>, <strong>inpNaam</strong>, <strong>txtError</strong>...
      </p>
    </div>
    <h5>opmaak</h5>
    <p>Opmaakeigenschappen kan je via het properties panel instellen, of rechtstreeks in de XAML:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-control-properties.png" alt="" class="w-800 bordered">
    </figure>
    <h5>layout</h5>
    <p>Een correcte flexibele layout maken vraagt best wel wat kennis en werk; dit komt in een apart hoofdstuk <a href="04_wpflayout.html">04. WPF layout</a> aan bod. Maar voorlopig kunnen we perfect uit de voeten met slepen, en handmatig aanpassen van <code>Padding</code> en <code>Margin</code>. De makkelijkste plaats is rechtstreeks in de XAML. Gebruik zoveel mogelijk <strong>afgeronde waarden</strong> voor een mooie layout:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-controls-layout.png" alt="" class="w-800 bordered">
    </figure>
    <h4>Events toevoegen</h4>
    <p>We willen uiteraard ook kunnen reageren op interacties met onze controls. Denk aan:</p>
    <ul>
      <li>klikken op een knop</li>
      <li>veranderen van een sliderwaarde</li>
      <li>selecteren van een item in een lijst</li>
      <li>tekst intikken in een tekstvak</li>
      <li>...</li>
    </ul>
    <p>
      Er zijn meerdere soorten events mogelijk op controls, b.v. een <code>Button</code> kent zowel <code>Click</code>, <code>MouseEnter</code> als MouseLeave events. Het &ldquo;meest logische&rdquo; event is het <strong>standaardevent</strong>; bij de <code>Button</code> is dat <code>Click</code>.
      Voeg een standaardevent toe door dubbelklikken op de control, of kies een willekeurig ander event via deâš¡knop van het properties panel:
    </p>
    <figure>
      <img src="img/04_visualstudio/wpf-event1.png" alt="" class="w-800 bordered">
      <figcaption>event handler in XAML code in MainWindow.xaml</figcaption>
    </figure>
    <p>Het toevoegen van een event heeft twee effecten:</p>
    <ul>
      <li>in de XAML code (bestand <em>MainWindow.xaml</em>) wordt een event handler methode gekoppeld aan een event</li>
      <li>in de code-behind (bestand <em>MainWindow.xaml.cs</em>) wordt een lege event handler methode aangemaakt</li>
    </ul>
    <figure>
      <img src="img/04_visualstudio/wpf-codebehind.png" alt="" class="w-800 bordered">
      <figcaption>event handler implementatie in code-behind in MainWindow.xaml.cs</figcaption>
    </figure>
    <h5>naam event handler aanpassen</h5>
    <p>De stijlregels (zie verder) vereisen dat alle namen van methodes met een hoofdletter beginnen. Pas daarom de naam aan zodat het begint met een hoofdletter:</p>
    <figure>
      <img src="img/04_visualstudio/rename1.png" alt="" class="w-500 bordered">
      <img src="img/04_visualstudio/rename2.png" alt="" class="w-500 bordered">
    </figure>
    <div class="tips" data-caption="ðŸ’¡ TIP">
      <p>
        Pas namen van variabelen, methodes e.d. nooit manueel aan maar altijd aan via <strong>Rename</strong> &mdash; zo ben je zeker dat de naam overal in je code (C#, XAML) correct aangepast wordt.
      </p>
    </div>

    <h3>Code-behind</h3>
    <p>De <mark>code-behind</mark>, dus de &ldquo;code achter het design&rdquo;, is het eigenlijke programma. Je vindt het terug in <strong>MainWindow.xaml.cs</strong>:</p>
    <figure>
      <img src="img/04_visualstudio/wpf-hello-cs.png" alt="" class="w-800 bordered">
    </figure>

    <h3>Voorbeeld: WpfHalloWereld</h3>
    <p>Je zou nu in staat moeten zijn volgend WPF programma in elkaar te steken:</p>
    <figure>
      <img src="img/04_visualstudio/WpfHelloWorld XAML.png" alt="" class="w-800 bordered">
      <figcaption>WpfHalloWorld design</figcaption>
    </figure>
    <figure>
      <img src="img/04_visualstudio/WpfHelloWorld CS.png" alt="" class="w-800 bordered">
      <figcaption>WpfHalloWorld code-behind</figcaption>
    </figure>
    <figure>
      <img src="img/04_visualstudio/WpfHalloWereld.gif" alt="" class="w-500">
      <figcaption>resultaat</figcaption>
    </figure>
    <h3>Null exceptions in event handlers</h3>
    <p>
      Let op als je <strong>in de XAML een property instelt die een event handler kan triggeren</strong>. Je riskeert controls aan te spreken die nog niet gelezen zijn, met een null-exception tot gevolg. Neem volgen eenvoudig voorbeeld:
    </p>
    <p>
      Neem volgend ogenschijnlijk onschuldig voorbeeld, met de bedoeling de geselecteerde waarde van een <code>Slider</code> in een <code>TextBlock</code> te tonen:
    </p>
    <pre class="language-html language-xaml"><code>&lt;Slider x:Name="sld1" Value="50" Minimum="1" Maximum="100" ValueChanged="Sld1_ValueChanged" Margin="20,20,20,0" VerticalAlignment="Top" /&gt;
&lt;TextBlock x:Name="txt1" Text="" Margin="20,50,0,0" HorizontalAlignment="Left" VerticalAlignment="Top"/&gt;</code></pre>
    <pre><code>public MainWindow() {
   InitializeComponent();
}
private void Sld1_ValueChanged(object sender, RoutedPropertyChangedEventArgs&lt;double&gt; e) {
   txt1.Text = $"{sld1.Value:F0}";
}</code></pre>
    <p>Dit geeft volgende foutmelding:</p>
    <figure>
      <img src="img/04_visualstudio/null-exception.png" alt="" class="w-800 bordered">
    </figure>
    <p>Het probleem in detail:</p>
    <ol>
      <li>in regel 2 van de XAML wordt de waarde van de slider ingesteld met <code>Value="100"</code></li>
      <li>dit triggert <code>Sld1_ValueChanged()</code> via <code>ValueChanged="Sld1_ValueChanged"</code></li>
      <li>in die event handler wordt de waarde van de <code>TextBlock</code> ingesteld met <code>txt1.Text = $"{sld1.Value:F0}";</code></li>
      <li>dit spreekt de TextBlock <code>txt1</code> aan, maar die staat pas in regel 3 van de XAML, en is dus nog niet gekend &rarr; <code>null</code>!</li>
    </ol>
    <p>Dit probleem geldt niet alleen voor <code>Value</code>, maar ook voor <code>Minimum</code> en <code>Maximum</code>; ze triggeren de event handler te vroeg. De oplossing is eenvoudig: stel <code>Value="50" Minimum="1" Maximum="100"</code> in de code-behind in, na <code>InitializeComponent()</code>, de regel die alle XAML inleest:</p>
    <pre class="language-html"><code>&lt;!-- geen Value, Minimum of Maximum meer in XAML --&gt;
&lt;Slider x:Name="sld1" ValueChanged="Sld1_ValueChanged" Margin="20,20,20,0" VerticalAlignment="Top" /&gt;</code></pre>
    <pre><code>public MainWindow() {
   InitializeComponent();
   // stel slider waarden hier in, zodat ze Sld1_ValueChanged() niet te vroeg triggeren
   sld1.Minimum = 1;
   sld1.Maximum = 100;
   sld1.Value = 50;
}</code></pre>
    <figure>
      <img src="img/04_visualstudio/null-exception.gif" alt="" class="w-500">
    </figure>
    <div class="tips" data-caption="ðŸ’£SAMENGEVAT">
      <p style="font-size: larger;">Stel properties die event handers kunnen triggeren in de code-behind in, niet in de XAML!</p>
    </div>

    <h2>Media en andere bestanden toevoegen</h2>
    <p>
      Om bestanden als afbeeldingen of geluidsfragmenten toe te voegen aan je project, volg je deze stappen:
    </p>
    <ol>
      <li>maak een map aan in je project voor de media bestanden via <strong>Add, New Folder...</strong></li>
      <li><strong>drag drop</strong> de afbeeldingen in deze map uit verkenner</li>
      <li>selecteer bij de properties voor elke afbeelding bij <i>Build Action</i> <strong>Content</strong> en bij <i>Copy to Output Directory</i> <strong>Copy always</strong>:</li>
    </ol>
    <figure>
      <img src="img/04_visualstudio/image-toevoegen.png" alt="" class="w-250 bordered">
    </figure>
    <div class="tips" data-caption="ðŸ¥¸ NIET VERGETEN!">
      <p>Deze laatste stap mag je niet vergeten! Anders zullen je bestanden niet gevonden worden bij de uitvoering van je programma.</p>
    </div>

    <h2>Solutions en projecten aanpassen</h2>
    <h3>Bestaand project toevoegen of verplaatsen uit andere solution</h3>
    <p>Stappen:</p>
    <ol>
      <li>kopieer de projectmap naar de doelsolutionmap (als die er niet al in zit)</li>
      <li>voeg het project toe via rechtermuisknop, Add, Existing project... en selecteer het .csproj bestand van het project</li>
    </ol>
    <figure>
      <img src="img/04_visualstudio/project-add1.png" alt="" class="w-500 bordered">
    </figure>
    <div class="noprint">
      <p>Een video voor wie het graag eens gedemonstreerd ziet:</p>
      <video src="img/04_visualstudio/project-copy.mp4" width="800" controls></video>
    </div>
    <h3>Project verwijderen</h3>
    <p>Als je een project wil verwijderen, moet je twee stappen ondernemen:</p>
    <ol>
      <li>verwijder het project uit de solution</li>
      <li>verwijder het project van de harde schijf</li>
    </ol>
    <figure>
      <img src="img/04_visualstudio/project-delete1.png" alt="" class="w-500 bordered">
      <img src="img/04_visualstudio/project-delete2.png" alt="" class="w-300 bordered">
    </figure>
    <div class="noprint">
      <p>Een video voor wie het graag eens gedemonstreerd ziet:</p>
      <video src="img/04_visualstudio/project-remove.mp4" width="800" controls></video>
    </div>
    <h3>Naam solution wijzigen</h3>
    <p>Volg deze stappen om de naam van een solution te wijzigen, b.v. van SlnOld naar SlnNew:</p>
    <ol>
      <li>sluit de solution</li>
      <li>hernoem de solution folder naar SlnNew</li>
      <li>hernoem het .sln bestand naar SlnNew.sln</li>
      <li>(voor de zekerheid) open de solution folder eens in VS Code (dus <em>niet</em> Visual Studio) en vervang met search/replace overal SlnOld door SlnNew</li>
      <li>heropen de solution, en rebuild het</li>
    </ol>
    <div class="noprint">
      <p>Een video voor wie het graag eens gedemonstreerd ziet:</p>
      <video src="img/04_visualstudio/solution-rename.mp4" width="800" controls></video>
    </div>
    <h3>Naam project wijzigen</h3>
    <p>De naam van een project wijzigen vraagt best wel wat stappen. Een voorbeeld van WpfOld naar WpfNew:</p>
    <ol>
      <li>sluit de solution</li>
      <li>hernoem de project folder naar WpfNew</li>
      <li>hernoem het .csproj bestand naar SlnNew.csproj</li>
      <li>(voor de zekerheid) open de project folder eens in VS Code (dus <em>niet</em> Visual Studio) en vervang met search/replace overal WpfOld door WpfNew</li>
      <li>open de solution; het oude project WpfOld zal niet meer gevonden worden, verwijder die dus uit de solution</li>
      <li>voeg het nieuwe project WpfNew toe aan de solution</li>
      <li>hernoem in een willekeurig codebestand uit het project de namespace van WpfOld naar WpfNew</li>
      <li>rebuild het project</li>
    </ol>
    <div class="noprint">
      <p>Een video voor wie het graag eens gedemonstreerd ziet (eerst voor een Console toepassing, dan nog eens voor een WPF toepassng):</p>
      <video src="img/04_visualstudio/project-rename.mp4" width="800" controls></video>
    </div>


    <h2>StyleCop.Analyzers</h2>
    <p>
      Als programmeeur kan je eigenlijk niet zonder <strong>code analyse tools</strong>, denk maar aan b.v. <em>html-validate</em> voor HTML of <em>StyleLint</em> voor CSS. Features:
    </p>
    <ul>
      <li><strong>codingstijl</strong>: controle op consistente toepassing van hoofdletters, layout, commentaar, accolades...</li>
      <li><strong>optimalisatie</strong>: suggesties voor kortere, efficiÃ«ntere en beter leesbare code</li>
      <li><strong>foutopsporing</strong>: veel fouten komen voort uit slordigheden, die deze tools helpen vermijden</li>
      <li><strong>configuratie</strong>: via een configuratiebestand kun je de regels en de manier waarop ze afgedwongen worden personaliseren</li>
    </ul>
    <h3>Installatie</h3>
    <p>
      Voor C# gebruiken we de <mark>StyleCop.Analyzers</mark> NuGet package. Voeg het toe aan je project via de NuGet package manager:
    </p>
    <figure>
      <img src="img/04_visualstudio/StyleCop1.png" alt="" class="w-600 bordered">
      <figcaption>NuGet package manager</figcaption>
    </figure>
    <p>
      Zoek op &ldquo;StyleCop.Analyzers&rdquo; en vink alle projecten aan:
    </p>
    <figure>
      <img src="img/04_visualstudio/StyleCop2.png" alt="" class="w-600 bordered">
      <figcaption>Installatie in alle projecten</figcaption>
    </figure>
    <div class="tips" data-caption="ðŸ’£ PAS OP">
      <p>
        Als je een nieuw project toevoegt, moet je <strong>opnieuw</strong> naar dit scherm om ook bij dit project StyleCop aan te vinken!
      </p>
    </div>
    <h3>Configuratie</h3>
    <p>
      StyleCop.Analyzers heeft heel veel regels &mdash; teveel eigenlijk, zodat je massa's foutmeldingen krijgt. Gelukkig kan je de regels configureren met een <mark>.editorconfig</mark> in de solution map:
    </p>
    <figure>
      <img src="img/04_visualstudio/editorConfig.png" alt="" class="w-500 bordered">
      <figcaption>.editorConfig configuratiebestand in de solution</figcaption>
    </figure>
    <p>
      Dit bestand bevat alle configureerbare regels:
    </p>
    <figure>
      <img src="img/04_visualstudio/editorConfig2.png" alt="" class="w-500 bordered">
      <figcaption>.editorConfig regels</figcaption>
    </figure>
    <div class="tips" data-caption="ðŸ›‘ STOP">
      <p>
        Het is niet de bedoeling dat je zelf de regels gaat opstellen of veranderen. Voor elk vak zul je het configuratiebestand aangeleverd krijgen, zodat de regels voor alle studenten identiek zijn. Controleer gewoon of bestand aanwezig is, en zoniet, download het van Toledo en steek het in de solution.
      </p>
    </div>
    <h3>Problemen oplossen</h3>
    <p>Je moet uiteraard niet alleen StyleCop installeren, maar ook effectief alle fouten en waarschuwingen oplossen:</p>
    <figure>
      <img src="img/04_visualstudio/stylecop errors.png" alt="" class="w-800 bordered">
      <figcaption>StyleCop meldingen lezen</figcaption>
    </figure>

    <h2>Debugging</h2>
    <p>Het stap voor stap doorlopen van je code, en ondertussen de waarden van properties en variabele in het oog houden, heet <mark>debugging</mark>.</p>
    <h3>Breekpunt(en) plaatsen</h3>
    <p>Plaats overal waar je de uitvoering van het programma wil pauzeren een breekpunt in de grijze balk links:</p>
    <figure>
      <img src="img/04_visualstudio/debugging1.png" alt="" class="w-500 bordered">
      <figcaption>breekpunt plaatsen</figcaption>
    </figure>
    <h3>Programma doorlopen</h3>
    <p>Doorloop dan stap voor stap je programma:</p>
    <ul>
      <li><strong>continue</strong>: ga door tot het volgende breekpunt</li>
      <li><strong>step over</strong>: voer de volgende regel uit</li>
      <li><strong>step into</strong>: stap in een methode</li>
      <li><strong>step out</strong>: stap uit een methode</li>
    </ul>
    <figure>
      <img src="img/04_visualstudio/debugging2.png" alt="" class="w-300 bordered">
      <figcaption>programma doorlopen</figcaption>
    </figure>
    <h3>Variabelen inspecteren</h3>
    <p>Via de rechtermuisknop kan je een zgn. <mark>watch</mark> toevoegen aan een variabele:</p>
    <figure>
      <img src="img/04_visualstudio/debugging3.png" alt="" class="w-300 bordered">
      <figcaption>watch toevoegen</figcaption>
    </figure>
    <p>Je kan dan de waarde van variabelen observeren tijdens het debuggen:</p>
    <figure>
      <img src="img/04_visualstudio/debugging4.png" alt="" class="w-500 bordered">
      <figcaption>variabelen inspecteren</figcaption>
    </figure>
    <div class="noprint">
      <p>Een video voor wie het graag eens gedemonstreerd ziet:</p>
      <video src="img/04_visualstudio/debugging.mp4" width="800" controls></video>
    </div>






    <h2>Shortcuts</h2>
    <p>Typische Visual Studio shortcuts die je zou moeten kennen:</p>
    <table class="light">
      <thead>
        <tr>
          <th scope="col">Shortcut</th>
          <th scope="col">Betekenis</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td><code>Ctrl-K+D</code></td>
          <td><strong>D</strong>ocument format</td>
        </tr>
        <tr>
          <td><code>Ctrl-K+C, Ctrl-K+U</code></td>
          <td><strong>C</strong>omment, <strong>U</strong>ncomment geselecteerd blok</td>
        </tr>
        <tr>
          <td><code>F5</code></td>
          <td>programma starten</td>
        </tr>
        <tr>
          <td><code>Ctrl+F5</code></td>
          <td>programma starten zonder debugging</td>
        </tr>
        <tr>
          <td><code>F7</code></td>
          <td>open code behind</td>
        </tr>
        <tr>
          <td><code>Ctrl-Alt-=, Ctrl-Alt--</code></td>
          <td>zoom design view in / uit</td>
        </tr>
      </tbody>
    </table>
    <p>Nog enkele algemene shortcuts van elke tekst editor:</p>
    <figure>
      <img src="img/04_visualstudio/shortcuts general.png" alt="" class="w-600">
    </figure>


  </main>
  <footer>
    <img src="common/img/thats-all.jpg" alt="">
    <div class="footer__bottom">
      <p>@2024, Rogier van der Linde</p>
      <p>cursussen in dezelfde reeks: <a href="https://rogiervdl.github.io/HTML-course/">HTML</a> &mdash; <a href="https://rogiervdl.github.io/CSS-course/">CSS</a> &mdash; <a href="https://rogiervdl.github.io/JS-course/">Javascript</a> &mdash; <a href="https://rogiervdl.github.io/CS-course/">C#</a></p>
    </div>
  </footer>
  <a aria-label="up" id="up" href="#top"><span class="fas fa-chevron-circle-up"></span></a>
  <!-- scripts -->
  <script src="common/vendor/prism/prism.js"></script>
  <script src="common/vendor/hystmodal/hystmodal.min.js"></script>
  <script src="common/js/mode.js"></script>
  <script src="common/js/scripts.js"></script>
  <!-- Google tag (gtag.js) -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-Q7JWZ9HHW0"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag() { dataLayer.push(arguments); }
    gtag('js', new Date());

    gtag('config', 'G-Q7JWZ9HHW0');
  </script>
</body>

</html>
